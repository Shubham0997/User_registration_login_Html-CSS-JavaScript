<!--This page is the profile page of admin where they can check, update their profile and contains table with user data and funtionality to dete user-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>

    <!--
        css declarations
    -->

    <!--bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <!-- Fonts-->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">

    <!--External CSS-->
    <link rel="stylesheet" href="css\style.css">
    <link rel="stylesheet" href="css\navbar.css">


<style>
  /* table styling*/
    #myInput {
  
  background-position: 10px 12px; /* Position the search icon */
  background-repeat: no-repeat; /* Do not repeat the icon image */
  width: 100%; /* Full-width */
  font-size: 16px; /* Increase font-size */
  padding: 12px 20px 12px 40px; /* Add some padding */
  border: 1px solid #ddd; /* Add a grey border */
  margin-bottom: 12px; /* Add some space below the input */
}

#myTable {
  border-collapse: collapse; /* Collapse borders */
  width: 100%; /* Full-width */
  border: 1px solid #ddd; /* Add a grey border */
  font-size: 18px; /* Increase font-size */
  overflow-x:auto;
}

#myTable th, #myTable td {
  text-align: left; /* Left-align text */
  padding: 12px; /* Add padding */
}

#myTable tr {
  /* Add a bottom border to all table rows */
  border-bottom: 1px solid #ddd;
}

#myTable tr.header, #myTable tr:hover {
  /* Add a grey background color to the table header and on hover */
  background-color: #2a2c44;
}     


form{ 
      position:relative;
  margin-top: 30%;
  overflow-x:auto;
  overflow-y: auto;
    }

    </style>
   
<!--table search-->
<script>
    function searchUser() {
      // Declare variables
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("myTable");
      tr = table.getElementsByTagName("tr");
    
      // Loop through all table rows, and hide those who don't match the search query
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
    </script>


</head>
<body>

  <!--Scroll to the top button-->
  <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

  <!--Navbar-->
    <div class="topnav">
        <a class="active" href="#home">Home</a>
        <a href="#updateProfile">Update Profile</a>
        <a href="#searchUser">Search Users</a>
      </div>
    
      <!--Profile form-->
      <form onsubmit="return false" style="width: auto;  margin-left : 30vw;  margin-right : 30vw;margin-top: 10vw" id="home">
        <h3>Profile</h3><br>
        <output>Name    : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</output><output ><script>document.write(localStorage.getItem('FullName'));</script></output><br>
        <output>Userame : &nbsp;&nbsp;&nbsp;&nbsp;</output><output ><script>document.write(localStorage.getItem('Username'));</script></output><br>
        <output>Gender  : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</output><output ><script>document.write(localStorage.getItem('Gender'));</script></output><br>
        <output>Number : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</output><output ><script>document.write(localStorage.getItem('PhoneNumber'));</script></output><br>
        <output>Email : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</output><output ><script>document.write(localStorage.getItem('email'));</script></output><br>
        
        <button type="submit" value="submit" onclick="Logout();" >Log Out</button><!--Logout button-->

    </form>

  
    <!--Update/edit profile form-->
    <form name="update" style="width: auto; margin-left : 30vw;  margin-right : 30vw; margin-top: 10vw; " onsubmit="return false" id="updateProfile">
        <h3>Edit Profile</h3>
            
                    <input type="text" id="full_name" name="full_name" placeholder="Full Name" >
                    <input type="email" id="email" name="email" placeholder="Email Address" >
                    <input type="tel" id="number" name="number" placeholder="Phone Number" >
                    <select id="Gender" name="Gender" >
                        <option value="" disabled selected hidden>Choose Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Others">Others</option>
                      </select>
                    <input type="text" id="username" name="username" placeholder="Username" >
                    <input type="password" id="password" name="password" placeholder="Password" >
                    <button type="submit" value="submit" onclick="updateProfile();">Update</button> <!--update profile function-->
    </form>

 

    <!--Users table with search functionality-->
    <form onsubmit="return false" style="width:auto ; margin-left : 1vw; margin-right : 1vw; margin-top: 10vw;" id="searchUser">
      <input type="text" id="myInput" onkeyup="searchUser()" placeholder="Search for Username"> <!--search button-->
    <table id="myTable" style="margin-top: auto; margin-bottom: auto;">
      <tr class="header">
        <th style="width:300px;">Name</th>
        <th style="width:100px;">Username</th>
        <th style="width:100px;">Gender</th>
        <th style="width:100px;">Phone Number</th>
        <th style="width:100px;">Email</th>
        <th style="width:100px;"></th>
      </tr>
    </table>
  </form>

<!--Scroll to the top button functionality-->
  <script>
    //Get the button
    var mybutton = document.getElementById("myBtn");
    
    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};
    
    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
    }
    
    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }
    </script>


<script>

user_records=JSON.parse(localStorage.getItem("Users"))?JSON.parse(localStorage.getItem("Users")):[] //putting data from User array into user_records

buildTable(user_records) 

function buildTable(data){//fill up the table with user data
  var table = document.getElementById('myTable') //table to be filled

  for(var i =0; i<data.length; i++){ //looping through the array until data.length
      console.log(i);
      var row = `<tr>
                          <td>${data[i].FullName}</td>
                          <td>${data[i].Username}</td>
                          <td>${data[i].Gender}</td>
                          <td>${data[i].PhoneNumber}</td>
                          <td>${data[i].email}</td>
                          <td><button type="submit" value="Delete" onclick="removeItemOnce(${i})">Delete User</button></td> 
      
          </tr>`  
          table.innerHTML += row
  }
}

//remove user , triggered by Delete User button, using index
function removeItemOnce(index) {
console.log(index);
if (index > -1) {
  user_records.splice(index, 1);
  localStorage.setItem("Users",JSON.stringify(user_records));
  document.location.reload(true)
}
return user_records;
}

</script>

<!-- External JavaScript -->
<script src="js\profile.js"></script>
<script src="js\updateProfile.js"></script>

</body>
</html>